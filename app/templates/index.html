{% extends "base.html" %}

{% block content %}
    <!-- Dropdown form for selecting team -->
    <form action="{{ url_for('index') }}" method="GET">
        <label for="team">Select Team:</label>
        <select id="team" name="team">
            <!--for every team in db-->
             <option value="NA" selected>NA</option>
            {% for team in teams %}
            <option value="teamName">{{ team.name }}</option>
            {% endfor %}
        </select>

        <!-- Dropdown form for selecting year -->
        <label for="year" id="yearLabel" style="display: none;">Select Year:</label>
        <select id="year" name="year" style="display: none;"></select>

        <!--<label for="year" id="yearLabel" style="display: none;">Select Year:</label>
        <select id="year" name="year" style="display: none;">
            {% for year in years %}
            <option value="year"> year </option>
            {% endfor %}
        </select>-->





        <button type="submit">Submit</button>
    </form>

    <script>
        // Function to handle form submission
    function handleSubmit(event) {
        event.preventDefault(); // Prevent default form submission behavior

        // Get selected team and year
        var teamSelect = document.getElementById('team');
        var yearSelect = document.getElementById('year');
        var selectedTeam = teamSelect.value;
        var selectedYear = yearSelect.value;

        // Construct the URL
        var url = "/" + selectedTeam + "/" + selectedYear;

        // Redirect to the constructed URL
        window.location.href = url;
    }

        // Function to show or hide the year dropdown based on team selection
        function toggleYearDropdown() {
            var teamSelect = document.getElementById('team');
            var yearSelect = document.getElementById('year');
            var yearLabel = document.getElementById('yearLabel');

            // Get the selected team's data-years attribute
            var selectedTeam = teamSelect.options[teamSelect.selectedIndex];
            var years = selectedTeam.dataset.years.split(',');

            // Clear previous options and add new ones based on the selected team
            yearSelect.innerHTML = '';
            years.forEach(year => {
                var option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });


            if (teamSelect.value !== 'NA') {
                yearSelect.style.display = 'block'; // Show year select
                yearLabel.style.display = 'block'; // Show year label
            } else {
                yearSelect.style.display = 'none'; // Hide year select
                yearLabel.style.display = 'none'; // Hide year label
            }
        }

        // Call the function when the page loads and when the team selection changes
        window.addEventListener('DOMContentLoaded', toggleYearDropdown);
        document.getElementById('team').addEventListener('change', toggleYearDropdown);
        // handles submit being selected
        document.querySelector('form').addEventListener('submit', handleSubmit);

    </script>
{% endblock %}